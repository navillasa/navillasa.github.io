<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The K8s Doctor, or How I Learned to Stop Worrying and Debug 502s | Natalie Villasana</title>
    <meta name="description" content="The Problem Pattern">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="/assets/css/main.css">
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- SEO -->
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>The K8s Doctor, or How I Learned to Stop Worrying and Debug 502s | Natalie Villasana</title>
<meta name="generator" content="Jekyll v3.9.3" />
<meta property="og:title" content="The K8s Doctor, or How I Learned to Stop Worrying and Debug 502s" />
<meta name="author" content="Natalie Villasana" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="The Problem Pattern" />
<meta property="og:description" content="The Problem Pattern" />
<link rel="canonical" href="http://localhost:4000/blog/debugging-502-errors/" />
<meta property="og:url" content="http://localhost:4000/blog/debugging-502-errors/" />
<meta property="og:site_name" content="Natalie Villasana" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-08-18T00:00:00-04:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="The K8s Doctor, or How I Learned to Stop Worrying and Debug 502s" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Natalie Villasana"},"dateModified":"2025-08-18T00:00:00-04:00","datePublished":"2025-08-18T00:00:00-04:00","description":"The Problem Pattern","headline":"The K8s Doctor, or How I Learned to Stop Worrying and Debug 502s","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/blog/debugging-502-errors/"},"url":"http://localhost:4000/blog/debugging-502-errors/"}</script>
<!-- End Jekyll SEO tag -->

</head>
<body>
    <div class="blog-container">
    <div class="blog-nav">
        <a href="/" class="back-link">← Back to Portfolio</a>
    </div>
    
    <header class="blog-header">
        <h1 class="blog-title">The K8s Doctor, or How I Learned to Stop Worrying and Debug 502s</h1>
        
        <p class="blog-subtitle">A systematic approach to debugging port and protocol mismatches</p>
        
        <div class="blog-meta">
            
            
            <br><time datetime="2025-08-18T00:00:00-04:00">August 18, 2025</time>
            
        </div>
    </header>

    <div class="blog-content">
        <h2 id="the-problem-pattern">The Problem Pattern</h2>

<p>Throughout this project, I’ve hit the same type of issue repeatedly:</p>
<ul>
  <li><strong>Frontend</strong> looking for <code class="language-plaintext highlighter-rouge">dev-backend-service</code> instead of <code class="language-plaintext highlighter-rouge">prod-backend-service</code></li>
  <li><strong>ArgoCD ingress</strong> using port 443 instead of port 80</li>
  <li><strong>Vault</strong> connection errors due to service discovery issues</li>
  <li><strong>External Secrets</strong> pointing to wrong Vault paths</li>
</ul>

<p><strong>The common thread</strong>: 502 Bad Gateway errors caused by communication mismatches.</p>

<h2 id="the-502-error-what-it-really-means">The 502 Error: What It Really Means</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>502 Bad Gateway = "I can reach something, but it's not responding correctly"
</code></pre></div></div>

<p><strong>This is different from:</strong></p>
<ul>
  <li><strong>404</strong>: “I can’t find anything at this path”</li>
  <li><strong>503</strong>: “Service is temporarily unavailable”</li>
  <li><strong>Connection timeout</strong>: “I can’t reach anything at all”</li>
</ul>

<p><strong>502 specifically means</strong>: The proxy/load balancer reached a backend, but the backend response was invalid.</p>

<h2 id="the-systematic-debugging-approach">The Systematic Debugging Approach</h2>

<h3 id="step-1-identify-the-communication-chain">Step 1: Identify the Communication Chain</h3>

<p>Every 502 has a path like this:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Client → Load Balancer → Service → Pod
</code></pre></div></div>

<p>Find where it breaks by checking each link.</p>

<h3 id="step-2-check-backend-health-in-load-balancer">Step 2: Check Backend Health in Load Balancer</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Get detailed ingress status</span>
kubectl describe ingress &lt;ingress-name&gt; <span class="nt">-n</span> &lt;namespace&gt;

<span class="c"># Look for backend health status</span>
<span class="c"># Example output:</span>
ingress.kubernetes.io/backends: <span class="o">{</span>
  <span class="s2">"k8s1-backend-service-443"</span>:<span class="s2">"UNHEALTHY"</span>  <span class="c"># ← The smoking gun!</span>
<span class="o">}</span>
</code></pre></div></div>

<p><strong>Key indicators:</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">UNHEALTHY</code> = Backend isn’t responding on expected port/protocol</li>
  <li><code class="language-plaintext highlighter-rouge">HEALTHY</code> = Backend is fine, look elsewhere</li>
</ul>

<h2 id="pro-tips-for-faster-debugging">Pro Tips for Faster Debugging</h2>

<h3 id="1-use-port-forward-for-direct-testing">1. <strong>Use Port-Forward for Direct Testing</strong></h3>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Bypass ingress/service and test pod directly</span>
kubectl port-forward pod/&lt;pod-name&gt; 8080:8080
curl http://localhost:8080/health
</code></pre></div></div>

<h3 id="2-check-multiple-namespaces">2. <strong>Check Multiple Namespaces</strong></h3>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Service in wrong namespace is super common</span>
kubectl get services <span class="nt">--all-namespaces</span> | <span class="nb">grep</span> &lt;service-name&gt;
</code></pre></div></div>

<p>The key insight: Most 502 errors are configuration mismatches, not infrastructure failures. A systematic approach beats random troubleshooting every time.</p>

    </div>
</div>
</body>
</html>